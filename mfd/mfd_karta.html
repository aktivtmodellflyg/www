<!doctype html>
<html lang="sv">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Modellflygets dag - Kartan</title>
  <link rel="canonical" href="https://aktivtmodellflyg.se/mfd/mfd_karta.html">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="../css/style.css">

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
     integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
     crossorigin="">
   <style> #map { height: 400px; background: #eee; } </style>

   <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
 	
</head>
<body>

  <!-- Meny -->
  <nav class="navbar navbar-expand-md navbar-dark bg-secondary p-0">
    <div class="container">
      <a class="navbar-brand p-0" href="../index.html"><img src="../images/amf_90x90.png" alt="logo"></a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNav">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="mainNav">
        <ul class="navbar-nav ms-auto">
		  
          <li class="nav-item"><a class="nav-link" href="../mfd/mfd.html">
		  Modellflygets dag
		  </a></li>

          <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown1" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Modellflyg
          </a>
          <div class="dropdown-menu" role="menu" aria-labelledby="navbarDropdown1">
            <a class="dropdown-item" href="../mf/mf.html">Detta är modellflyg</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="../mf/unga.html">Unga</a>
            <a class="dropdown-item" href="../mf/avancera.html">Avancera</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="../mf/foto_event.html">Foto Tema & event</a>
            <a class="dropdown-item" href="../mf/foto_bygg.html">Foto Bygg & teknik</a>
            <a class="dropdown-item" href="../mf/foto_modell.html">Foto Modeller</a>
          </div>
          </li>

          <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown2" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Börja
          </a>
          <div class="dropdown-menu" role="menu" aria-labelledby="navbarDropdown2">
            <a class="dropdown-item" href="../borja/borja.html">Hur man börjar</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="../borja/radio.html">Radio</a>
            <a class="dropdown-item" href="../borja/laddare.html">Laddare</a>
            <a class="dropdown-item" href="../borja/modell_wing.html">Flygplan</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="../borja/butiker.html">Butiker</a>
          </div>
          </li>

          <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown3" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Utbildning
          </a>
          <div class="dropdown-menu" role="menu" aria-labelledby="navbarDropdown3">
            <a class="dropdown-item" href="../utb/regler.html">Regler</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="../utb/prova.html">Prova spaka</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="../utb/basic_plane.html">Uppbyggnad RC-Plan</a>
            <a class="dropdown-item" href="../utb/radio_setup.html">Sändarens knappar</a>
            <a class="dropdown-item" href="../utb/checklist.html">Checklista</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="../utb/tips.html">Byggtips</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="../utb/utb_links.html">Länkar</a>
          </div>
          </li>

          <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown4" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Uppdatera
          </a>
          <div class="dropdown-menu" role="menu" aria-labelledby="navbarDropdown4">
            <a class="dropdown-item" href="../update/update.html">Intro</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="../update/spektrum.html">Spektrum</a>
            <a class="dropdown-item" href="../update/futaba.html">Futaba</a>
            <a class="dropdown-item" href="../update/frsky.html">FrSky med Ethos</a>
            <a class="dropdown-item" href="../update/radiomaster.html">EdgeTX, ELRS & MM - RadioMaster</a>
          </div>
          </li>

          <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown5" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
		  Ladda ned
          </a>
          <div class="dropdown-menu" role="menu" aria-labelledby="navbarDropdown5">
            <a class="dropdown-item" href="../download/dl_mfd.html">För klubbar</a>
            <a class="dropdown-item" href="../download/dl_pilot.html">För piloter</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="../download/dl_links.html">Länkar</a>
          </div>
          </li>
		  
        </ul>
      </div>
    </div>
  </nav>

  <!-- Innehåll -->
  <main class="container py-4">
    <h1 class="h2">Klubbar som har aktivitet under Modellflygets dag - Besökskartan</h1>

    <p>
	  Klicka på en klubb i listan för att zooma dit <i>(listan är sorterad efter landskap)</i> eller zooma och dra i kartan.
	  <br>Klicka på en klubb i kartan för mer information.
	</p>
	
	<div class="container-fluid mt-3">
		<div class="row">
			<div class="col-md-4 order-2 order-md-1">
				<div class="list-group" id="klubb-lista" style="max-height: 600px; overflow-y: auto;">
					<div class="list-group-item">Lista över aktiva klubbar</div>
				</div>
			</div>

			<div class="col-md-8 order-1 order-md-2 mb-3">
				<div id="map" style="height: 600px; border-radius: 8px;"></div>
			</div>
		</div>
	</div>

<!--
    <div class="ratio ratio-16x9">
	  <iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vR49Lc3ZNULKPGSWtUjNV-0_7sLtNedDKltps6c8lND0Tmg9AKJYlRDjq-pLK_KR3AZFNyjqIO0eJ3z/pubhtml?gid=499287765&amp;single=true&amp;widget=true&amp;headers=false"></iframe>">
	</div>
-->
	<p>
      <a href="mfd.html">Tillbaka till 'Modellflygets dag'</a>
	</p>

	<hr>
	<p>
	  Deltar din klubb under Modellflygets dag men saknas på kartan ? <a href="mfd_registrera.html">Registrera din klubb här.</a>
	</p>
	
  </main>

  <footer class="bg-secondary text-white text-center py-3 mt-4">
	  <div class="container">
		<a href="../kontakt.html" class="text-white fw-bold text-decoration-none">Kontakt och policy</a>
		<span class="mx-2">|</span>
		<span>Vi ska ha kul tillsammans – En aktiv hobby i luften</span>
	  </div>
  </footer>

	<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
     integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
     crossorigin=""></script>
	 
	<script>
	    document.addEventListener("DOMContentLoaded", function () {
			var map = L.map('map').setView([61.0, 15.0], 5);

			L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
				attribution: '&copy; OpenStreetMap bidragsgivare'
			}).addTo(map);
		
			var csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR49Lc3ZNULKPGSWtUjNV-0_7sLtNedDKltps6c8lND0Tmg9AKJYlRDjq-pLK_KR3AZFNyjqIO0eJ3z/pub?gid=499287765&single=true&output=csv';

			Papa.parse(csvUrl, {
				download: true,
				header: true,
				complete: function(results) {
					var data = results.data;

					data.forEach(function(row) {
						if (row.Lat && row.Lng && row.Namn && row.Landskap && !row.Namn.startsWith('!DEL')) {
							// Skapa markör på kartan
							var marker = L.marker([parseFloat(row.Lat), parseFloat(row.Lng)]).addTo(map);
							let Namn ="";


							// Skapa en klickbar rad i Bootstrap-listan
							var listItem = document.createElement('button');
							listItem.className = 'list-group-item list-group-item-action';
							
							if( row.Namn.startsWith('Prel')) {
							  Namn = row.Namn.slice(4).trim();
							  
							  listItem.innerHTML = `<small>${row.Landskap}</small> <i>Preliminärt</i> <b>${Namn}</b>`;

 							  marker.bindPopup(`
								  <i class="amf">Preliminär anmälan</i>
								  <br>${Namn}
								  <br><b>Klockan:</b> ${row.Tid}
								  <br><b>Hemsida:</b> <a href="${row.Web}" target="_blank" rel="noopener noreferrer">${row.Web}</a>
							  `);
							} else {
							  listItem.innerHTML = `<small>${row.Landskap}</small> <b>${row.Namn}</b>`;

 							  marker.bindPopup(`
								  <b>${row.Namn}</b>
								  <br><b>Klockan:</b> ${row.Tid}
								  <br><b>Hemsida:</b> <a href="${row.Web}" target="_blank" rel="noopener noreferrer">${row.Web}</a>
							  `);

							}
							
							// När man klickar i listan: Zooma in på kartan och öppna popupen
							listItem.onclick = function() {
								map.flyTo([row.Lat, row.Lng], 14);
								marker.openPopup();
							};

							document.getElementById('klubb-lista').appendChild(listItem);
						}
					});

				}
			});


		});
	</script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>